> If you were able to successfully deploy DVWA within Azure (Module 11), you DO NOT need to complete the pre-work and can use your cloud environment as the lab environment for this unit.

## Pre-Work Objective:

Students will leverage critical skills and techniques in containerization, networking, and web application security to deploy and configure a DVWA (Damn Vulnerable Web Application) container within their home security testing lab environments. By the end of this, students will be able to

- bUtilize Docker commands to effectively manage the DVWA container.
- Configure a Docker network for secure communication between containers.
- Document the configuration process.

## Pre-Work Instructions:
#### Instructions for Windows & Mac Intel Chip Users:
Follow the instructions below for installing and configuring your DVWA container within your ubuntu server VM (the target server).
1. Verify that your target server is configured within the hypervisor with two network adapters. The first should be configured as a "bridge network" adapter, and the second should configured as "host-only" adapter that is private to your Mac.
2. Verify that your Kali or Parrot VM (red team VM) is configured within the hypervisor with two network adapters as well. The first should be configured as a "bridge network" adapter, and the second should configured as "host-only" adapter that is private to your Mac.
3. Within your target server, verify that you have docker installed, if not execute the command apt update and apt install -y docker.io.
4. Verify that Docker is installed by running `docker --version`.
5. Pull the kaakaww/dvwa-docker container image by running `docker pull vulnerables/web-dvwa`.
6. Verify that you have successfully pulled the docker container image by running docker images.
7. Run the docker container by executing `docker run --rm -it -d -p 8080:80 -e DVWA_DB_HOST=db --name dvwa vulnerables/web-dvwa`. To learn more about this command look below.
8. Stop firewalld from running through executing `systemctl stop firewalld`, and verify that firewalld has been stoped through running `systemctl status firewalld`.
9. Stop ufw from running through executing `ufw disable`, and verify that ufw has been stoped through running ufw status.
10. Log into your red team VM, and verify that you can communicate with the target VM by pinging its IP address.
11. If you can ping the target server from your red team VM, within the red team VM use netcat to send a HTTP request to the target server and test connectivity by running `echo -e "GET /setup.php HTTP/1.1\r\nHost: <target_server_IP>:8080\r\nConnection: close\r\n\r\n" | nc <target_server_ip> 8080`.
12. If netcat returns the HTML page, verify that you can use curl to connect to your target VM by running `curl -v --http1.1 http://<target_server_ip>:8080/setup.php`.
13. If curl returns the HTML page as well, go to your browser and copy and paste the URL used within the previous curl command. You should be presented with the web page below the  Mac ARM chip instructions.
14. At the bottom of the web page click the "create and reset database" button.
15. Once DVWA is locally hosted, download and install [Nessus Essential](https://www.tenable.com/tenable-for-education/nessus-essentials?edu=true) to your Red Team VM, put "The Sola Foundation" as the organization.
16. Start Nessus Scanner by runningsudo systemctl start nessusd.service, then verify that the nessusd service is running by executing `sudo systemctl status nessusd.service`.
17. Go to `https://Red_Team_VM_IP:8834/` to configure your scanner. Accept the risk, and continue.
18. Once you have access to the Nessus application, select continue (do not check register offline).
19. Choose "Register for Nessus Essentials" when asked how you want to deploy Nessus.
20. Go to the email you provided and enter the activation code provided for Nessus Essentials, and click continue.
21. Create a Nessus admin user account, and continue to complete setup.

> Note: If executing the netcat or curl commands fail, on your ubuntu server VM run `docker logs dvwa`.

#### Instructions for Mac ARM Chip Users:
Follow the instructions below for installing and configuring your DVWA container within your ubuntu server VM (the target server).
1. Verify that your target server is configured within the hypervisor with two network adapters. The first should be configured as a "bridge network" adapter, and the second should configured as "host-only" adapter that is private to your Mac.
2. Verify that your Kali or Parrot VM (red team VM) is configured within the hypervisor with two network adapters as well. The first should be configured as a "bridge network" adapter, and the second should configured as "host-only" adapter that is private to your Mac.
3. Within your target server, verify that you have docker installed, if not execute the command `apt update` and `apt install -y docker.io`.
4. Verify that Docker is installed by running `docker --version`.
5. Pull the kaakaww/dvwa-docker container image by running `docker pull kaakaww/dvwa-docker`.
6. Verify that you have successfully pulled the docker container image by running `docker images`.
7. Run the docker container by executing `docker run --rm -it -d -p 8080:80 -e DVWA_DB_HOST=db --name dvwa kaakaww/dvwa-docker`.  To learn more about this command look below.
8. Stop firewalld from running through executing `systemctl stop firewalld`, and verify that firewalld has been stoped through running `systemctl status firewalld`.
9. Stop ufw from running through executing `ufw disable`, and verify that ufw has been stopped through running `ufw status`.
10. Log into your red team VM, and verify that you can communicate with the target VM by pinging its IP address.
11. If you can ping the target server from your red team VM, within the red team VM use netcat to send a HTTP request to the target server and test connectivity by running `echo -e "GET /setup.php HTTP/1.1\r\nHost: <target_server_IP>:8080\r\nConnection: close\r\n\r\n" | nc <target_server_ip> 8080`.
12. If netcat returns the HTML page, verify that you can use curl to connect to your target VM by running `curl -v --http1.1 http://<target_server_ip>:8080/setup.php`.
13. If curl returns the HTML page as well, go to your browser and paste the URL used within the previous curl command. You should be presented with the web page below.
14. At the bottom of the web page click the "create and reset database" button.
15. Once DVWA is locally hosted, download and install [Nessus Essential](https://www.tenable.com/tenable-for-education/nessus-essentials?edu=true) to your Red Team VM, put "The Sola Foundation" as the organization.
16. Start Nessus Scanner by runningsudo systemctl start nessusd.service, then verify that the nessusd service is running by executing `sudo systemctl status nessusd.service`.
17. Go to `https://Red_Team_VM_IP:8834/` to configure your scanner. Accept the risk, and continue.
18. Once you have access to the Nessus application, select continue (do not check register offline).
19. Choose "Register for Nessus Essentials" when asked how you want to deploy Nessus.
20. Go to the email you provided and enter the activation code provided for Nessus Essentials, and click continue.
21. Create a Nessus admin user account, and continue to complete setup.
        
> Note: If executing the netcat or curl commands fail, on your ubuntu server VM run sudo docker logs dvwa.



```
sudo docker run --rm -it -d -p 8080:80 -e DVWA_DB_HOST=db --name <container-name> <docker-container-image> /bin/bash -c "php 0.0.0.0:80 -t /var/www/html"

-- rm
This flag tells Docker to automatically remove the container once it stops running. 
This helps keep your environment clean by not leaving stopped containers lying around.
Remove this flag if you would like to continue working within the same container.

-it
Combines two flags
-i (interactive): Keeps STDIN open even if not attached.
-t (tty): Allocates a pseudo-TTY, which allows you to interact with the container via a terminal interface.

-d:
This flag runs the container in detached mode, meaning it will run in the background. 
This is useful for web applications that need to stay active without tying up your terminal session.

-p 8080:80:
This option maps port 80 inside the container (where the web application is running) to port 8080 on 
the host machine. This means you can access the web application by going to http://localhost:8080 on 
your host machine.

-e DVWA_DB_HOST=db:
This sets an environment variable DVWA_DB_HOST with the value db inside the container. This variable is 
used by DVWA to connect to its database.

--name <container_name> <docker_container_image>:
Used to provide a name for the container you are creating from the docker image. This name can be used to 
reference the container later (e.g., starting, stopping, or removing it).

# Remainder is used for forcing network configuraiton within the container

/bin/bash -c
This tells Docker to run a bash shell command inside the container. 
The -c option allows you to pass a command as a string.

"php 0.0.0.0:80 -t /var/www/html":
This is the command that will be executed inside the container. It starts the PHP built-in web server:
0.0.0.0:80: This tells the server to listen on all interfaces (including the one mapped to port 
8080 on the host) at port 80.

-t /var/www/html: 
The -t option specifies the document root of the web server. 
This is where the web application files (like those for DVWA) are located.

```

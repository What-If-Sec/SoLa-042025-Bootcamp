## Activity Objectives

Students will use Wireshark to analyze a PCAP (Packet Capture) file containing ARP (Address Resolution Protocol) requests and replies. By examining the ARP traffic, students will gain a deeper understanding of how ARP operates, including how devices resolve IP addresses to MAC addresses on a local network as well as how to detect ARP spoofing attacks.



## Activity Instructions

Complete the following tasks:

1. Launch Wireshark within your Ubuntu VM and open the packet capture provided [here](https://drive.google.com/file/d/1EevxCHmd8j_tW3QCfHshnZu_f3mQBn1B/view).
2. In the top filter bar,  filter out for any ARP activity.
3. Look for lines with `Who has <IP Address>? Tell <IP address`, to understand the baseline behavior. As this line indicates a device trying to resolve the MAC address of another IP on the network.
4. Examine and document the source IP and MAC in these requests to learn which devices are genuinely communicating on the network.
5. Look for lines with `<IP address> is at ,MAC address>`, these are devices responding with their MAC address.
6. Create a table that lists each unique IP address along with its corresponding MAC address, based on the legitimate ARP replies you observed.
7. If two or more different MACs are mapped to the same IP, that’s a red flag for ARP spoofing. Or, if a MAC address suddenly appears claiming to be multiple different IPs, that could also be an indicator.
8. Go to `Statistics -> Endpoints -> Ethernet Tab` to view the MAC addresses and associated traffic, and identify the address with the most transmitted (Tx) packets.
9. Right click the address identified, and select `Apply as Filter -> Selected`, to filter based off the MAC address of interest.
10. Locate duplicate IP warnings by scrolling through the packet list pane and looking for lines that say Duplicate IP address detected for [IP] ([MAC]) - also in use by [MAC] (frame ###). These messages are generated by Wireshark when it sees two different MAC addresses claiming the same IP address.
11. For each duplicate IP warning document the IP address in conflict, the two MAC addresses involved, and the frame number listed.
12. Identify the potential attacker by looking for any MAC address that appears in multiple conflicts. A legitimate device typically only claims one IP address.
13. Submit your answers to the questions below.



### Activity Reflection

Using the ARP traffic and duplicate IP address warnings in the PCAP file, write a clear and concise paragraph that answers the following:
1. How many duplicate IP address warnings do you see in the PCAP file?
2. What IP address and MAC address pairs were  involved in each conflict?
3. Which MAC address appears in multiple conflicts?
4. Based on your observations, which MAC address is most likely the source of the ARP spoofing attack?

Your paragraph should explain how you identified the attacker based on patterns in the ARP replies and duplicate IP warnings. Be specific, but keep it brief.





